2020-11-05 16:35:55,865-INFO-Tensorflow version 2.3.1
2020-11-05 16:35:55,865-INFO-dataset path: TRAIN_DATA_FOLDER=/home/tobi/Downloads/trixsyDataset/training_dataset
2020-11-05 16:35:55,865-INFO-TRAIN_DATA_FOLDER=/home/tobi/Downloads/trixsyDataset/training_dataset
SRC_DATA_FOLDER=/home/tobi/Downloads/trixsyDataset/source_data
2020-11-05 16:35:59,767-INFO-creating new empty model
2020-11-05 16:35:59,861-INFO-Model: "sequential_1"
2020-11-05 16:35:59,861-INFO-_________________________________________________________________
2020-11-05 16:35:59,861-INFO-Layer (type)                 Output Shape              Param #   
2020-11-05 16:35:59,861-INFO-=================================================================
2020-11-05 16:35:59,862-INFO-conv1 (Conv2D)               (None, 54, 54, 64)        7808      
2020-11-05 16:35:59,862-INFO-_________________________________________________________________
2020-11-05 16:35:59,862-INFO-batch_normalization_2 (Batch (None, 54, 54, 64)        256       
2020-11-05 16:35:59,862-INFO-_________________________________________________________________
2020-11-05 16:35:59,862-INFO-max_pooling2d_3 (MaxPooling2 (None, 26, 26, 64)        0         
2020-11-05 16:35:59,862-INFO-_________________________________________________________________
2020-11-05 16:35:59,862-INFO-conv2 (Conv2D)               (None, 26, 26, 64)        102464    
2020-11-05 16:35:59,863-INFO-_________________________________________________________________
2020-11-05 16:35:59,863-INFO-batch_normalization_3 (Batch (None, 26, 26, 64)        256       
2020-11-05 16:35:59,863-INFO-_________________________________________________________________
2020-11-05 16:35:59,863-INFO-max_pooling2d_4 (MaxPooling2 (None, 12, 12, 64)        0         
2020-11-05 16:35:59,863-INFO-_________________________________________________________________
2020-11-05 16:35:59,864-INFO-conv3 (Conv2D)               (None, 12, 12, 128)       73856     
2020-11-05 16:35:59,864-INFO-_________________________________________________________________
2020-11-05 16:35:59,864-INFO-conv4 (Conv2D)               (None, 12, 12, 128)       147584    
2020-11-05 16:35:59,864-INFO-_________________________________________________________________
2020-11-05 16:35:59,864-INFO-max_pooling2d_5 (MaxPooling2 (None, 5, 5, 128)         0         
2020-11-05 16:35:59,864-INFO-_________________________________________________________________
2020-11-05 16:35:59,864-INFO-flatten_1 (Flatten)          (None, 3200)              0         
2020-11-05 16:35:59,865-INFO-_________________________________________________________________
2020-11-05 16:35:59,865-INFO-fc8 (Dense)                  (None, 100)               320100    
2020-11-05 16:35:59,865-INFO-_________________________________________________________________
2020-11-05 16:35:59,865-INFO-dropout_1 (Dropout)          (None, 100)               0         
2020-11-05 16:35:59,865-INFO-_________________________________________________________________
2020-11-05 16:35:59,865-INFO-output (Dense)               (None, 2)                 202       
2020-11-05 16:35:59,866-INFO-=================================================================
2020-11-05 16:35:59,866-INFO-Total params: 652,526
2020-11-05 16:35:59,867-INFO-Trainable params: 652,270
2020-11-05 16:35:59,867-INFO-Non-trainable params: 256
2020-11-05 16:35:59,867-INFO-_________________________________________________________________
2020-11-05 16:35:59,867-INFO-making training generator
2020-11-05 16:35:59,867-INFO-making training generator
2020-11-05 16:36:02,962-INFO-making validation generator
2020-11-05 16:36:03,358-INFO-making test generator
2020-11-05 16:36:03,750-INFO-summary of /home/tobi/Downloads/trixsyDataset/training_dataset/train/: 223135 samples:	160935/72.124% nonjoker,	62200/27.876% joker

2020-11-05 16:36:03,750-INFO-summary of /home/tobi/Downloads/trixsyDataset/training_dataset/valid/: 27892 samples:	20117/72.125% nonjoker,	7775/27.875% joker

2020-11-05 16:36:03,750-INFO-summary of /home/tobi/Downloads/trixsyDataset/training_dataset/test/: 27892 samples:	20117/72.125% nonjoker,	7775/27.875% joker

2020-11-05 16:36:03,883-INFO-starting training
2020-11-05 16:36:03,883-INFO-Training uses class_weight={0: 0.9, 1: 0.1} (nonjoker/joker) with max 300 epochs optimizer=<tensorflow.python.keras.optimizer_v2.gradient_descent.SGD object at 0x7f101a483550> and train_batch_size=32 
2020-11-05 17:33:12,576-INFO-Done with model.fit; history is 
{'loss': [0.02619902417063713, 0.006034947000443935, 0.0027695833705365658, 0.002175366273149848, 0.001614743727259338, 0.001406580675393343, 0.0007444308721460402, 0.0009263250976800919, 0.0006020432920195162, 0.0005336384056136012, 0.00034220595262013376, 0.00018722479580901563, 0.00028026525978930295, 0.000443476892542094, 0.00038289627991616726, 0.00022874459682498127, 0.000453069107607007, 0.0002745764213614166, 9.733743354445323e-05, 5.505518493009731e-05, 4.0368566260440275e-05, 0.00037429266376420856], 'categorical_accuracy': [0.9337934255599976, 0.9867838025093079, 0.993873655796051, 0.9953615665435791, 0.996634304523468, 0.9970331788063049, 0.9984179735183716, 0.998041570186615, 0.9988751411437988, 0.9989781975746155, 0.9993143081665039, 0.9996370077133179, 0.9994487762451172, 0.9991484880447388, 0.9992246627807617, 0.9995787143707275, 0.9991260766983032, 0.9994577169418335, 0.9997848868370056, 0.999879002571106, 0.9999417662620544, 0.9994218945503235], 'val_loss': [0.06840460002422333, 0.05148787796497345, 0.010823055170476437, 0.010165027342736721, 0.021017378196120262, 0.006835632026195526, 0.005643647164106369, 0.008291438221931458, 0.0050948928110301495, 0.00477514136582613, 0.004105411935597658, 0.005303042009472847, 0.007977060042321682, 0.004756510723382235, 0.004900301340967417, 0.003401852212846279, 0.004613968543708324, 0.007526929955929518, 0.004933373536914587, 0.003558250842615962, 0.004148389678448439, 0.0060324822552502155], 'val_categorical_accuracy': [0.978596031665802, 0.9828265905380249, 0.9965581297874451, 0.9965940117835999, 0.9938691854476929, 0.997597873210907, 0.9984583258628845, 0.9976695775985718, 0.9985300302505493, 0.9988885521888733, 0.9990678429603577, 0.9987093210220337, 0.9980998039245605, 0.9988168478012085, 0.9990319609642029, 0.9992112517356873, 0.9987093210220337, 0.9984225034713745, 0.9989244341850281, 0.9993546605110168, 0.9993187785148621, 0.9987093210220337]} and is saved as logs/training_history-20201105-1635.npy
2020-11-05 17:33:12,576-INFO-history.history.keys()=dict_keys(['loss', 'categorical_accuracy', 'val_loss', 'val_categorical_accuracy'])
2020-11-05 17:33:12,994-INFO-saving model to folder models/joker_net_20201105-1635
2020-11-05 17:33:14,246-INFO-converting model to tensorflow lite model
2020-11-05 17:33:14,783-INFO-saving tflite model as models/joker_net_20201105-1635/joker_net.tflite
2020-11-05 17:33:14,785-INFO-evaluating accuracy
2020-11-05 17:33:32,875-INFO-On test set /home/tobi/Downloads/trixsyDataset/training_dataset/test/  loss=0.006, acc=0.9985
2020-11-05 17:33:50,433-INFO-**** final test set balanced accuracy: 99.744% (chance would be 50%)
Confusion matrix nonjoker/joker:
 [[20115     2]
 [   39  7736]]
2020-11-05 17:33:50,433-INFO-**** done training after 57.9m; model saved in models/joker_net_20201105-1635.
See logs/training-20201105-1635.log for logging output for this run.
